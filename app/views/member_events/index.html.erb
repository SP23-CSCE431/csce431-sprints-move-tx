<p style="color: green"><%= notice %></p>

<h2>Member Events</h2>

<div id="member_events">
  <%# shows events that need to be checked off on if user is an admin %>
  <%if @user.position != "Member"%>
    <h2> My Approvals: </h2>

    <table class="listing" id="Approve By list" summary="Approve By list" style="width: 100%;">
      <!-- table heads -->
      <tr class="header">
        <th class="table-head">Event</th>
        <th class="table-head">Date</th>
        <th class="table-head">Member</th>
        <th class="table-head">Approved status</th>
        <th class="table-head">Approved By</th>
        <th class="table-head">File</th>
      </tr>
      <!-- Display each member -->
      <% @member_events.each do |member_event| %>

        <% if member_event.approve_by.to_s.include?(@user.name)%>
          <tr>
            <td> <%= member_event.event.name %></td>
            <td> <%= member_event.event.date %></td>
            <td> <%= member_event.member.name %></td>
            <td> <%= member_event.approved_status %></td>
            <td> <%= member_event.approve_by %></td>
            <% if member_event.file.attached?%>
              <td> <%= link_to member_event.file.filename, member_event.file  %></td>
            <% else %>
              <td>n/a</td>
            <% end %>

            <!-- Actions for each member event -->
            <td class="actions">
              <%= link_to("Show this member event", member_event_path(member_event), class: 'action show') %>
            </td>
          </tr>
        <% end %>
      <% end %>
    </table>
  <% end %>

  <%# shows all events user has entered  %>
  <h2> My Services: </h2>
    <table class="listing" id="My Services" summary="My Services" style="width: 100%;">
      <!-- table heads -->
      <tr class="header">
        <th class="table-head">Event</th>
        <th class="table-head">Date</th>
        <th class="table-head">Approved status</th>
        <th class="table-head">Approved By</th>
        <th class="table-head">File</th>
      </tr>
      <!-- Display each member -->
      <% @member_events.each do |member_event| %>

        <% if member_event.member_id == @user.id && member_event.event.event_type == "Service" %>
          <tr>
            <td> <%= member_event.event.name %></td>
            <td> <%= member_event.event.date %></td>
            <td> <%= member_event.approved_status %></td>
            <td> <%= member_event.approve_by %></td>
            <% if member_event.file.attached?%>
              <td> <%= link_to member_event.file.filename, member_event.file  %></td>
            <% else %>
              <td>n/a</td>
            <% end %>

            <!-- Actions for each member event -->
            <td class="actions">
              <%= link_to("Show this member event", member_event_path(member_event), class: 'action show') %>
            </td>
          </tr>
        <% end %>
      <% end %>
    </table>

  <%# shows all meetings user have attended %>
  <h2> My Meetings: </h2>
    <table class="listing" id="My Meetings" summary="My Meetings" style="width: 100%;">
      <!-- table heads -->
      <tr class="header">
        <th class="table-head">Event</th>
        <th class="table-head">Date</th>
      </tr>
      <!-- Display each member -->
      <% @member_events.each do |member_event| %>

        <% if member_event.member_id == @user.id && member_event.event.event_type == "Meeting" %>
          <tr>
            <td> <%= member_event.event.name %></td>
            <td> <%= member_event.event.date %></td>

            <!-- Actions for each member event -->
            <td class="actions">
              <%= link_to("Show this member event", member_event_path(member_event), class: 'action show') %>
            </td>
          </tr>
        <% end %>
      <% end %>
    </table>
</div>

<%= link_to "New Service event", new_member_event_path(version: 1) %>
<br>
<%= link_to "Meeting Sign in", new_member_event_path(version: 2) %>
